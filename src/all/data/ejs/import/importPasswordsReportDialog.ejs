<?
let resourcesSuccess = true;
let foldersSuccess = true;
if(this.resources.errors.length > 0) {
    resourcesSuccess = false;
}
if(this.foldersIntegration === true && this.folders && this.folders.errors.length > 0) {
    foldersSuccess = false;
}
?>
<div class="dialog-wrapper">
    <div class="dialog report">
        <div class="dialog-header">
            <? if (resourcesSuccess && foldersSuccess) { ?>
            <h2>Success!</h2>
            <? } else { ?>
            <h2>Something went wrong!</h2>
            <? } ?>
            <a class="dialog-close" role="button">
                <i class="fa fa-close"></i><span class="visuallyhidden">close</span>
            </a>

        </div>
        <div class="js_dialog_content dialog-content">

            <form class="tab-content ready selected" id="js_rs_import_report">
                <div class="form-content">
                    <? if (resourcesSuccess) { ?>
                    <p><strong><?= this.resources.created.length ?> passwords have been imported successfully.</strong></p>
                    <? } else { ?>
                    <p class="error inline-error">There was an issue while importing passwords:</p>
                    <? } ?>
                    <? if (!resourcesSuccess) { ?>
                    <p>
                        <strong><?= this.resources.created.length ?> out of <?= (this.resources.created.length + this.resources.errors.length) ?></strong> passwords have been imported.
                    </p>
                    <? } ?>
                    <? if(this.foldersIntegration === true) { ?>
                        <? if (foldersSuccess) { ?>
                        <p><strong><?= this.folders.created.length ?> folders have been imported successfully.</strong></p>
                        <p>You can find the newly imported passwords under the top folder: '<?= this.importTag ?>'.</p>
                        <? } else { ?>
                        <p class="error inline-error">There was an issue while importing folders:</p>
                        <? } ?>
                    <? } ?>
                    <? if (!foldersSuccess) { ?>
                    <p>
                        <strong><?= this.folders.created.length ?> out of <?= (this.folders.created.length + this.folders.errors.length) ?></strong> folders have been imported.
                    </p>
                    <? } ?>
                    <? if (!resourcesSuccess || !foldersSuccess) { ?>
                    <div class="accordion error-details closed">
                        <div class="accordion-header">
                            <a role="link">Errors details</a>
                        </div>
                        <div class="accordion-content hidden" style="display: none;">
                            <div class="input text">
                                <label for="js_field_debug" class="visuallyhidden">Errors details</label>
                                <textarea id="js_field_debug"><?= JSON.stringify(this.resources.errors, null, 4); ?><? if(this.foldersIntegration === true) { JSON.stringify(this.folders.errors, null, 4); } ?></textarea>
                            </div>
                        </div>
                    </div>
                    <? } ?>
                </div>
                <div class="submit-wrapper clearfix">
                    <input class="button primary" value="Ok" type="submit">
                </div>
            </form>
        </div>
    </div>
</div>